<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.theoldsweb.myweb.web.mapper.NewsMapper">
  <resultMap id="BaseResultMap" type="com.theoldsweb.myweb.common.entity.News">
    <!--
      WARNING - @mbg.generated
    -->
    <result column="id" jdbcType="INTEGER" property="id" />
    <result column="new_id" jdbcType="VARCHAR" property="newId" />
    <result column="new_title" jdbcType="VARCHAR" property="newTitle" />
    <result column="new_digest" jdbcType="VARCHAR" property="newDigest" />
    <result column="new_main_body" jdbcType="VARCHAR" property="newMainBody" />
    <result column="new_pic" jdbcType="VARCHAR" property="newPic" />
    <result column="comments_id" jdbcType="VARCHAR" property="commentsId" />
    <result column="new_type" jdbcType="INTEGER" property="newType" />
    <result column="new_giveALike" jdbcType="INTEGER" property="newGivealike" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
  </resultMap>

  <select id="getList" resultType="com.theoldsweb.myweb.common.dto.NewsDto">
    select
    *
    from
    news
    <choose>
      <when test="selectType==1">
        where new_type=#{newsDto.newType}
      </when>
      <when test="selectType==2">
        order by new_giveALike desc
      </when>
      <when test="selectType==3">
        order by LENGTH(comments_id) desc
      </when>
      <when test="selectType==4">
        order by create_time desc
      </when>
    </choose>
    ;
  </select>
  <update id="updateCommentsByNewId">
       UPDATE `news`
        SET
        `comments_id` =CONCAT(comments_id,',',#{commentsId}),
        `update_time` = #{ date }
        WHERE
            `new_id` = #{newsId};
  </update>

</mapper>